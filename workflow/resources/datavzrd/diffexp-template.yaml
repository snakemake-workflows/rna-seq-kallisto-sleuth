name: ?f"Differential expression analysis for model {wildcards.model}"
datasets:
  transcripts_results:
    path: ?input.transcripts
    separator: "\t"
views:
  transcripts:
    dataset: transcripts
    desc: |
      Differentially expressed transcripts** using the model ``{{   snakemake.params.model["full"] }}``, computed with sleuth. The columns ``b_*`` and ``b_*_se`` display the effect size  :math:`\beta` and the corresponding standard error for every   covariate in the model. They are analog to log2 fold changes. Note that non-binary covariates are binarized by sleuth, leading  to multiple columns ``b_*1``, ``b_*2``, etc. In addition, a signed version of the pi-value score (as proposed  by `Xiao et al. 2014 <https://dx.doi.org/10.1093/bioinformatics/ btr671>`_) is shown. The sign reflects the sign of the effect (i.e. positive for   upregulation, negative for downregulation).
    page-size: 25
    render-table:
      columns:
        Name:
          display-mode: normal
          link-to-url: "http://reactome.org/PathwayBrowser/#/{Ids}"
        number of genes on the pathway:
          display-mode: normal
          plot:
            heatmap:
              scale: linear
              range:
                - white
                - "#186904"         
        number of DE genes per pathway:
          display-mode: normal
          plot:
            heatmap:
              scale: linear
              range:
                - white
                - "#186904"
        p-value for at least NDE genes:
          display-mode: hidden
          plot:
            heatmap:
              scale: linear
              range:
                - "#1f77b4"
                - white
        total perturbation accumulation:
          custom: |
            function(value, row) {
              if (value < 0) {
                return `<div style="background-color: #e6550d;">${value}</div>`;
              } else if (value > 0) {
                return `<div style="background-color: #6baed6">${value}</div>`;
              } else {
                return `${value}`;
              }
            }
        p-value to observe a total accumulation:
          display-mode: hidden
          plot:
            heatmap:
              scale: linear
              range:
                - "#1f77b4"
                - white
        Combined p-value:
          display-mode: hidden
          plot:
            heatmap:
              scale: linear
              range:
                - "#1f77b4"
                - white
        Combined FDR:
          plot:
            heatmap:
              scale: linear
              range:
                - "#1f77b4"
                - white
        Combined Bonferroni p-values:
          display-mode: hidden
          plot:
            heatmap:
              scale: linear
              range:
                - "#1f77b4"
                - white         
        Status:
          plot:
            heatmap:
              scale: ordinal
              color-scheme: accent       
        Ids:
          display-mode: hidden
          link-to-url: "http://reactome.org/PathwayBrowser/#/{value}"

        # Add view configuration for each column.
        # I suggest to have a tick plot with log scale for the FDRs, and a heatmap for the direction of the perturbation.